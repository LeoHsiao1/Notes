# 插件

k8s 的软件生态比较开放，有很多插件。

## API

- k8s 内部的一些组件通过 API 相互调用，并且定义了 API 规范。
  - 采用 gRPC 协议进行通信。
  - API 规范使得 k8s 组件之间比较解耦，有利于模块化设计、更换组件。
  - 例如 k8s 容器运行时的 API 规范是 CRI ，如果一个插件符合该 API 规范，则可以替换 k8s 默认的容器运行时组件。

- 容器运行时接口（Container Runtime Interface ，CRI）
  - ：供 kubelet 调用担任容器运行时的组件，从而管理容器、镜像。
  - 早期的 k8s 默认采用 Docker 作为容器引擎，因为 Docker 是当时最流行的容器引擎。
    - 后来 k8s 社区制定了 CRI 规范，但 Docker 不符合该规范。因此 k8s 社区开发了一个符合 CRI 规范的 dockershim 模块，通过它间接调用 dockerd ，从而管理容器。
    - 2020 年， k8s 社区认为维护 dockershim 模块比较麻烦，因此弃用 dockershim 模块，建议用户改用 containerd 或 CRI-O 作为 CRI 组件。
      - 不使用 dockershim 模块，就不能通过 docker 命令查看、管理 kubelet 部署的容器。但用 docker build 命令构建的镜像符合 OCI 标准，依然可以被 containerd 或 CRI-O 运行。
    - 2021 年，Mirantis 公司和 Docker 公司联合开发 cri-dockerd 项目，用于继续实现 dockershim 的功能，从而不必用户更换 CRI 组件。

- 容器网络接口（Container Network Interface ，CNI）
  - ：供 k8s 管理容器的网络。

- 容器存储接口（Container Storage Interface ，CSI）
  - ：供 k8s 管理容器的存储层。
  - k8s 本身提供了 hostPath、ConfigMap 等类型的 volume 。而一些第三方的存储程序可通过 CSI 接口接入 k8s 集群，提供一些其它类型的 volume 。



<!-- ## 部署应用 -->


