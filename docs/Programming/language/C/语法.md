# 语法

## 语法特点

- 用 C 语言编写的源代码，一般保存为两种文件：
  - 源文件：扩展名为 `.c` ，主要用于保存各个函数。
  - 头文件：扩展名为 `.h` ，主要用于保存各个变量、函数的声明语句。
- C 语言是编译型语言。源代码不能直接作为程序运行，需要用 gcc 等工具，编译成可执行文件，才能运行。
- C 语言是强类型语言。所有变量，都必须声明数据类型，才能使用。

### 主函数

下例是一个 C 语言源文件 test.c ：
```c
#include <stdio.h>    // 导入头文件 stdio.h ，从而可以使用 printf() 和 scanf() 函数

void main(void){      // 定义主函数
    int x = 0;        // 创建一个变量
    printf("Please enter an integer: ");// 在终端显示一行字符串，给用户看
    scanf("%d", &x);                    // 从终端读取一个值，保存到变量中
    printf("You entered: %d\n ", x);    // 将变量的值打印到终端
    return 0;                           // 终止函数，并返回一个数值
}
```

- 用 C 语言编程时，需要定义有且仅有一个 `main()` 函数，又称为主函数，作为程序运行的入口。
  - 每个函数由一组语句组成，按从上往下的顺序，依次执行这些语句。
  - 每个函数中，可以调用其它任意个函数。
  - 主函数执行的最后一条语句，通常是 `return 0` ，表示终止函数并返回数值 0 。而主函数一旦终止，该程序也运行结束，又称为程序退出。
    - 退出码通常为 0 ，表示该程序正常终止。
    - 如果退出码不为 0 ，则表示该程序异常终止。

- 定义主函数时，有几种格式：
  - 没有返回值，也没有形参：
    ```c
    void main(void)
    ```
  - 返回值为 int 类型，但没有形参：
    ```c
    int main(void)
    ```
  - 返回值为 int 类型，形参用于接收命令行参数：
    ```c
    int main(int argc, char *argv[])
    ```
    假设将该源文件编译为 `test` ，然后在终端执行 `test a b 1 2` 。则操作系统会运行该程序，并传入参数：
    - 将 argv 数组的长度，传给 argc 。本例取值为 5 。
    - 将所有命令行参数（包括程序名称），保存为一个 `char *` 型指针数组，传给 argv 。本例 `argv[0]` 取值为 `test` 。

### 语句

- 语句（statement），是 C 语言代码的基本组成单位。
  - 每条语句必须以分号 `;` 结尾。否则编译器不能识别每条语句到第几个字符结束。
  - 通常在每条语句末尾，加一个换行符。因为如果将多条语句写在同一行，则比较拥挤，不方便人类阅读。

- C 语言的语句分为多种：
  - 空语句
    - ：仅有一个分号，不执行任何操作。
  - 声明语句
    - ：比如声明某个变量的数据类型、声明某个函数头。
  - 执行语句
    - ：比如给某个变量赋值、调用某个函数、执行一个表达式。
  - 复合语句
    - ：用花括号 `{ }` 包住的多条语句，称为一个语句块。

- 缩进
  - 一个语句块，应该在每行开头增加一层缩进，从而方便人类阅读。
  - 如果不加缩进，则代码难以阅读，但并不影响程序的运行。
  - 每层缩进，建议使用两个 Tab ，相当于 8 个空格的长度。如下：
    ```c
    if (x == 1) {
            return x;
    }
    ```
  - 如果一个语句块，只包含一行语句，则可以省略花括号。如下：
    ```c
    if (x == 1)
            return x;
    ```
  - 同时最多使用三层缩进，避免代码太复杂。

- 可以将 C 语言代码中的某些字符，声明为注释，从而被编译器忽略。
  - 单行注释：可以在某行插入 `//` ，将该符号右侧的所有字符，声明为注释。
  - 多行注释：可以在第 m 行插入 `/*` ，在第 n≥m 行插入 `*/` ，从而将这两个符号之间的所有字符，声明为注释。
  - 注释通常用于介绍一段代码的用途、希望达到的效果。而代码本身是怎么写的，应该让人一看就懂，不需要讲解。

## 变量

### 标识符

- 变量名、函数名等名称，统称为标识符。
  - 每个标识符的命名格式：
    - 可以由阿拉伯数字、英文字母、下划线几种字符组成。
    - 不能以数字开头。
    - 字母区分大小写。
  - `int`、`char` 等名称，是 C 语言的关键字，用户不能创建与它们同名的标识符。

- C/C++ 中，标识符包含英文字母时，应该大写还是小写？
  - 变量名、函数名采用下划线命名法，所有字母都小写。例如：`my_name`
  - 结构体名、类名采用大驼峰命名法，每个单词的首字母大写。例如 `MyName`
  - 常量名采用下划线命名法，所有字母都大写。例如：`MY_NAME`

### 创建

- 变量，是一个有名字的容器，可以存储一个值，然后读取该值。如下：
  ```c
  int x;    // 声明一个 int 类型的变量，命名为 x
  x = 1;    // 给变量 x 赋值为整数 1
  printf("%d\n", x);  // 读取变量 x 的值，打印到终端
  ```

- 使用变量时，应该遵守该流程：声明变量 -> 赋值 -> 读值
  - 如果不声明变量的数据类型，C 语言编译器就不知道，应该给该变量分配多大容量的内存空间，作为容器来存储值。
    - 例如 char 类型的变量，占用 1 byte 大小的内存空间，或者说容量为 1 byte 。
    - 例如 int 类型的变量，占用 4 bytes 大小的内存空间，或者说容量为 4 bytes 。
    - 虽然变量的声明语句，决定了分配多大容量的内存空间。但编译器执行到变量的赋值语句时，才会实际分配内存空间。
  - 可以在声明变量数据类型的同时，进行赋值，这称为变量的定义语句。例：
    ```c
    int x = 1;
    ```
    - 变量的定义（definition）语句，相当于声明（declaration）+赋值（assignment）。
    - 同一个变量，只能声明一次数据类型，但可以多次声明 extern 。不过声明 extern 的同时，不能进行赋值。
    - 换句话说，同一个变量，只能存在一个定义语句，可以存在多个声明语句。
  - 可以在一个语句中，同时声明、赋值多个变量：
    ```c
    int x, y;
    int a = 1, b =2;
    ```
  - 语法错误：
    ```c
    x = 1;      // 这里会报错变量 x undeclared ，不能赋值或读值
    int x;
    ```
  - 语法错误：
    ```c
    int x;      // 第一次声明变量时，会在当前作用域创建该变量
    int x;      // 创建一个变量之后，不能再次声明它的数据类型
    ```
  - 如果用户声明了一个变量，尚未进行第一次赋值（称为变量的初始化），就读取该变量的值，如下。则会读取到一个不可预测的值，可能导致程序出错。
    ```c
    int x;
    printf("%d\n", x);
    ```
    - 为了避免这种情况，某些编译器，会在创建变量时，自动赋一个默认值。比如执行 `int x;` 时，自动给变量 x 赋值为 0 。
    - 为了避免这种情况，某些编译器，会检查代码中的各个变量，如果一个变量尚未赋值就被读取，则抛出 warning 报错。
    - 为了避免这种情况，用户可以养成习惯，总是在声明变量的同时，赋一个默认值，比如 `int x = 1;` 。不过这样增加了一次主动赋值操作，会略微增加一点程序运行耗时。

- 声明变量的数据类型时，还可以添加 const、extern、static 等关键字，声明变量的特殊属性。

### 作用域

- 创建一个变量之后，它就会一直占用内存空间。什么时候才会删除该变量，回收其内存空间呢？
  - C 语言不支持用户主动删除一个变量。而是等到当前代码块执行结束时，自动删除变量。
  - 每个变量在创建之后、删除之前，可以在程序的某些区域访问该变量（读值、赋值）。这些区域，称为该变量的作用域（scope）。

根据作用域的不同，将变量分为几类：

- 局部变量
  - 在 `{}` 代码块中声明的变量，属于局部变量。
  - 当该代码块执行结束时，会自动删除其中所有局部变量。
  - 例：
    ```c
    {
        int x = 0;              // 创建局部变量 x
        printf("%d\n", x);      // 可以在当前代码块中，访问局部变量 x
        {
            printf("%d\n", x);  // 可以在嵌套内层代码块中，访问局部变量 x
        }
    }
    printf("%d\n", x);          // 在外层代码块中，访问不到局部变量 x 。这里会报错变量 x undeclared
    ```
  - 访问变量 x 时，会先检查当前代码块中，是否存在名为 x 的变量。如果不存在，则检查外层代码块中，是否存在名为 x 的变量，存在的话就使用它。
    ```c
    int x;
    {
        printf("%d\n", x);  // 当前代码块不存在名为 x 的变量，因此使用外部代码块的 int x 变量
        char x = 'A';
        printf("%c\n", x);  // 当前代码块存在名为 x 的变量，因此使用它
    }
    ```

- 全局变量
  - 在函数之外声明的变量，属于全局变量。
  - 所有函数，都属于全局代码块的内层代码块，因此所有函数内都能访问到全局变量.
  - 假设在一个源文件中声明了一个全局变量，则当前文件中的所有代码，都可以访问该全局变量。但从其它文件访问不到，除非使用 extern 关键字。
  - 优点：
    - 全局变量，可以在所有函数内访问，方便这些函数之间分享信息。
  - 缺点：
    - 全局变量会一直存活，一直占用栈区内存空间。因此，如果用户只需要短期使用一个变量，应该创建局部变量。
    - 不方便知道哪些函数使用了全局变量。因此不敢随便修改全局变量，不知道会影响哪些函数。换句话说，增加了代码的耦合度。
  - 例：
    ```c
    int a = 0;        // 全局变量
    extern int b;     // 外部变量

    int main(void){
        int a = 0;    // 局部变量
        return 0;
    }
    ```

- 静态变量
  - 声明变量时，如果添加关键字 static ，则会将它声明为静态变量。
  - 静态变量的特点是，在其作用域结束之后，不会被编译器自动销毁。等到下次执行当前代码块时，会继续使用该变量。
  - 例如，循环执行以下代码块，每次执行，都会重新创建局部变量 x ，并赋值为 0 ：
    ```c
    while(1){
        int x = 0;
        x++;
        printf("%d\n", x);
    }
    ```
    如果将变量 x 声明为静态变量，则它只会被创建一次，随后每次循环，取值因为 `x++;` 而不断递增：
    ```c
    while(1){
        static int x = 0; // C 语言程序在编译时，会事先创建静态变量并初始化。等到正式执行该代码块时，会忽略静态变量的定义语句
        x++;
        printf("%d\n", x);
    }
    ```
  - 优点：
    - 可以保留变量的值，方便下次使用。
  - 缺点：
    - 让变量一直存活，一直占用内存空间。

- 外部变量
  - 声明变量时，如果添加关键字 extern ，则会将它声明为外部变量。表示该变量的定义语句不在当前代码块，请编译器到外部代码块（通常是 include 的其它文件），寻找该变量的定义语句。
  - 例：
    ```c
    #include <stdio.h>

    int x = 0;
    int main() {
        extern int x;         // 此时编译器会到外部代码块，寻找变量 int x ，于是发现全局变量 int x
        // extern int x = 0;  // 语法错误。用 extern 声明变量的同时，不能进行赋值
        printf("%d\n", x);
        return 0;
    }
    ```
  - 如果声明了一个外部变量，但从未使用它（读取、赋值），则编译器不会寻找该变量的定义语句。因此，即使不存在该变量的定义语句，也不会报错。
    ```c
    #include <stdio.h>

    int main() {
        extern int x;
        return 0;
    }
    ```
  - 所有函数，默认都为外部函数，不必再用 extern 声明。
  - 与 extern 相反，如果将变量、函数用 static 声明，则只允许从当前文件访问，不允许从其它文件访问。

根据存储方式的不同，将变量分为几类：
- auto 类型
  - 用关键字 auto 声明的变量，属于自动类型。
  - 创建这种变量时，编译器会自动分配内存空间给它。作用域结束时，编译器会自动回收它的内存空间。
  - 比如局部变量、函数的形参，它们默认属于 auto 变量。
    ```c
    int main() {
        int x = 0;  // 相当于 auto int x = 0;
        return 0;
    }
    ```
- static 类型
- extern 类型
- register 类型
  - 用关键字 register 声明的变量，会存储在 CPU 芯片的寄存器中。
  - 普通的变量，存储在计算机内存中。程序每次读写该变量，需要将变量从内存拷贝到寄存器中，才能被 CPU 直接读写。
  - 如果将变量一直存储在 CPU 寄存器中，就能被 CPU 更快地读写。不过一般程序没必要这么追求速度。
  - register 只能用于声明局部变量，不能声明全局变量。
  - register 类型的变量，不支持通过 & 获取内存地址。

## 数据类型

- 每个变量，有且仅有一种数据类型，决定了该变量占用多少内存空间、允许存储什么类型的值。
- C 语言中，变量的数据类型分为几类：
  - 空类型（void）
    - 表示不存在值。
    - 例如很多函数的参数、返回值为 void 类型。
  - 基本数据类型
    - 整型 short、int、long
    - 浮点型 float、double
    - 字符型 char
    - C 语言中没有字符串型变量（C++ 中才有），只有字符串型常量。
  - 枚举
  - 数组
  - 指针
  - 结构体

- 每个变量在声明数据类型之后，不允许修改数据类型。但表达式的返回值，可以修改数据类型。分为两种情况：
  - 自动类型转换
    - 不同数据类型的几个值，在混合运算时，会自动转换成其中容量最大的那个数据类型。
    - 转换顺序为：`char,short -> int -> unsigned int -> long -> unsigned long -> double`
    - 例：
      ```c
      printf("%d\n", 1+'A');    // 运算结果为 int 类型，输出为：66
      printf("%lf\n", 1+3.14);  // 运算结果为 double 类型，输出为：4.140000
      ```
    - float 参与运算时，一律转换为 double 。甚至两个 float 之间的运算，都要转换为 double 。
  - 强制类型转换
    - 进行赋值时，= 右侧的表达式返回值，会强制转换成 = 左侧的变量数据类型。
      ```c
      float x = 1;        // 此时整数 1 会被转换成浮点数
      printf("%f\n", x);  // 输出为：1.000000
      printf("%f\n", 1);  // 如果直接打印整数 1 ，则不兼容 %f 格式控制符，输出为：0.000000
      ```
    - 用 `(数据类型名)(表达式)` 的格式，可以强制转换表达式返回值的数据类型。
      ```c
      printf("%d\n", (int)3.14);    // 浮点型转换成整型时，会丢掉小数部分。输出为：3
      printf("%lf\n", 1/3);         // 运算结果为 int 类型，输出为：0.000000
      printf("%lf\n", (float)1/3);  // 运算结果为 float 类型，输出为：0.333333
      ```

- 用 `sizeof(变量名)` 或 `sizeof(数据类型名)` 的格式，可以查询一个变量或数据类型，占用的内存大小，单位为 bytes 。
  - sizeof 不是函数，而是一个关键字，称为容量运算符。
  - sizeof 的返回值，在编译期间就会确定。
  - 例：
    ```c
    printf("%d\n", sizeof(int));  // 输出为：4
    ```
  - 字节（byte）是计算机常用的存储单位，而位（bit）是最小的存储单位。
  - 每个字节，由 8 个 bit 组成。

- 用关键字 `typedef` ，可以给某个数据类型，创建一个别名。
  - 例：
    ```c
    typedef unsigned int u16;   // 给 unsigned int 数据类型，创建 u16 别名。最后一个字段就是别名
    u16 x;

    typedef char * String;
    typedef struct{...} Horse;  // 像定义一个类
    ```

### 整型

- 在数学中，整数是指不含小数点的数字。
- 在 C 语言中，整数通常存储在以下数据类型的变量中：
  - `short`
    - 称为短整型（short integer）
    - 占用内存空间的容量为 2 字节。
  - `int`
    - 称为整型（integer）
    - int 的容量，取决于本机 CPU 字长。
      - 在 16 位 CPU 上，int 的容量为 16 bits ，即 2 字节。
      - 在 32 位 CPU 上，int 的容量为 32 bits ，即 4 字节。
      - 在 64 位 CPU 上，int 的容量为 64 bits ，即 8 字节。
    - 例：
      ```c
      int x;
      x = 3;      // 3 是 int 型常量，可以被赋值给 int 型变量
      x = 3.14;   // 3.14 是 double 型常量，如果赋值给 int 型变量，则会丢掉小数部分，只剩整数部分
      printf("%d\n", x);
      ```
  - `long`
    - 称为长整型（long integer）
    - 在 32 位 CPU 上，long 的容量为 4 字节。在 64 位 CPU 上，long 的容量为 8 字节。
  - `long long`
    - 称为双长整型。
    - 容量为 8 字节。
    - 32 位 CPU 不支持使用该数据类型，64 位 CPU 才支持。

- short 的容量为 2 字节，也就是使用 16 bits 来存储数字。那么能存储多大的数字？
  - 将这 16 个二进制位，从 0 开始编号。
  - 默认将最高位，也就是第 15 位，用于存储正负号，称为符号位。取值 0 表示正号，取值 1 表示负号。
  - 剩下的其它位，可以自由赋值。
    - 绝对值最大的正数，二进制值为 `0111 1111 1111 1111`，等于十进制的 `2^15 - 1 = 32767` 。
    - 绝对值最大的负数，二进制值为 `1111 1111 1111 1111`，等于十进制的 `-32767` 。
    - 另外，`0000 0000 0000 0000` 转换成十进制是 0 ，`1000 0000 0000 0000` 转换成十进制是 -0 。而 -0 没有用处，通常将这个数值用于表示 -32768 。
  - 因此，如果用 short 型变量存储一个整数，则取值范围为 ``-(2^15)` 至 `+(2^15-1)` ，也就是 `-32768` 至 `+32767` 。
  - 用户给 short 型变量赋值时，如果超过正常取值范围，则会导致二进制的最高位被修改，正负号反转，该现象称为数值溢出。如下：
    ```c
    short x = 32767;
    printf("%d\n", x);  // 输出为：32767 ，正常

    x = 32768;
    printf("%d\n", x);  // 输出为：-32768

    x++;
    printf("%d\n", x);  // 输出为：-32767

    x = -32768;
    printf("%d\n", x);  // 输出为：-32768 ，正常

    x--;
    printf("%d\n", x);  // 输出为：32767
    ```
  - 同理，如果 int 的容量为 4 字节，则取值范围为 `-(2^31)` 至 `+(2^31-1)` 。
  - 为了扩大变量的取值范围，可以不记录正负号，将最高位也用于存储数值。这样的变量，称为无符号型变量（unsigned）。例如：
    ```c
    unsigned char   // 取值范围为 0 至 2^8 -1 = 255
    unsigned short  // 取值范围为 0 至 2^16 -1 = 65535
    unsigned int
    unsigned long
    ```
    - 与之相对，默认数据类型的变量，称为有符号型变量（signed）。
    - 浮点数 float、double 必须记录正负号。因为浮点数按照 IEEE754 标准进行存储，而且浮点数的取值范围本就很大，一般不需要扩大范围。

## 运算符

- 很多语句包含一个表达式。表达式用于对变量、常量进行某种运算，得到一个值。
- 一个表达式，由运算符（又称为操作符）和操作数组成。
  - 运算符，表示运算的类型，分为多种。
  - 操作数，是运算符的操作对象。
    - 例如 `x = 1 + 2` 中， `=`、`+` 是运算符，`x`、`1`、`2` 是操作数。

- 赋值运算符：
  ```c
  a = 表达式  // 将表达式的值，存储到变量 a 中
  ```
  - 可以在 = 的左侧加一个算术运算符，从而在赋值之前，先执行算术运算。例：
    ```c
    int a = 10;
    a += 1+2;
    printf("%d\n", a);  // 输出为 13
    ```
  - `a = 表达式` 本身是一个赋值表达式，将当前的赋值作为返回值。因此，可以在一个语句中使用多个赋值运算符，从右到左依次赋值。例：
    ```c
    int x, y;
    x = y = 1;      // 相当于 x = ( y = 1)
    ```
  - 不能在创建变量的同时，多重赋值：
    ```c
    int x = y = 1;  // 这里会报错变量 y 未定义，因为创建多个变量时，必须以逗号分隔
    ```

- 算术运算符：
  ```c
  a + b   // 加法
  a - b   // 减法
  a * b   // 乘法
  a / b   // 除法
  a % b   // 取模
  ```
  - 两个数字做除法时，
    - 如果两个数字，都是整型，则返回值会是整型。此时采用商作为返回值，而余数会被丢弃。
    - 如果任一数字，是浮点型，则返回值会是浮点型。此时余数以小数的形式保留。
    - 例：
      ```c
      printf("%d\n", 1/2);    // 输出为：0
      printf("%f\n", 1/2.0);  // 输出为：0.500000
      printf("%f\n", 2/2.0);  // 输出为：1.000000 ，这里即使能整除，没有余数，返回值也是浮点型
      ```
  - 取模运算，是对两个整型数字，做除法，然后返回余数。例：
    ```c
    printf("%d\n", 0%2);    // 输出为：0
    printf("%d\n", 1%2);    // 输出为：1
    ```

- 关系运算符：
  ```c
  a >  b  // 大于
  a <  b  // 小于
  a >= b  // 大于等于
  a <= b  // 小于等于
  a == b  // 等于
  a != b  // 不等于
  ```
  - 关系运算符，又称为比较运算符，用于比较两个值的大小。
  - 这些比较运算，用汉语描述，有两种结果：真、假。
    - 在 C 语言中，这两种结果分别用整型 1、0 表示。如下：
      ```c
      printf("%d\n", 1>2);  // 1>2 这个表达式，输出为：0
      ```
    - 在 C++ 语言中，这两种结果分别用布尔值 true、false 表示。

- 逻辑运算符：
  ```c
  condition1 && condition2  // 逻辑与。如果两个条件表达式都为 true ，则逻辑运算的结果为 true ，否则结果为 false
  condition1 || condition2  // 逻辑或。如果两个条件表达式，至少一个为 true ，则逻辑运算的结果为 true 。如果两个都为 false ，则结果为 false
  ! condition1              // 逻辑非。如果表达式取值为 true ，则f反转为 false 。如果表达式取值为 false ，则反转为 true
  ```
  - 逻辑运算符，用于组合两个条件表达式。例：
  ```c
  printf("%d\n", (1>2) && (3>2)); // 输出为：0
  printf("%d\n", (1>2) || (3>2)); // 输出为：1
  printf("%d\n", !(1>2));         // 输出为：1
  ```

- 位运算符：
  ```c
  a & b    // 按位与。检查两个操作数的二进制位（bit），如果第 n 位都为 1 ，则结果的第 n 位为 1 ，否则结果的第 n 位为 0

  a | b    // 按位或。如果 a 或 b 的第 n 位为 1 ，则结果的第 n 位为 1 。如果两者都为 0 ，则结果的第 n 位为 0
  a ^ b    // 按位异或。如果 a 与 b 的第 n 位不相同，则结果的第 n 位为 1 ，否则结果的第 n 位为 0
  a << 3   // 按位左移。将操作数的二进制值左移几位，然后在右边空位补上 0
  a >> 3   // 按位右移。
  ~a       // 按位取反。将操作数每一位的值，取反
  ```
  - 位运算用于修改操作数的二进制值，也就是修改某些位（bit）。要求操作数必须是整型。

- 上述运算符，书写格式大多为 `操作数1 运算符 操作数2` ，存在两个操作数，因此属于二元运算符。
- 以下是自增、自减运算符，属于一元运算符：
  ```c
  ++  // 自增
  --  // 自减
  ```
  - 使用 `++` ，可以在读取一个变量的取值的同时，将该变量的取值加 1 。
  - 如果 `++` 放在变量的左侧，则称为前缀自增。会先将该变量的值加 1 ，然后读取该变量的值。例如 `b=++a` 相当于 `a=a+1; b=a;` 。
  - 如果 `++` 放在变量的右侧，则称为后缀自增。会先读取该变量的值，将该变量的值加 1 。例如 `b=a++` 相当于 `b=a; a=a+1;` 。
  - 例：
    ```c
    int a=0;
    printf("%d\n", ++a);  // 输出为：1
    printf("%d\n", a);    // 输出为：1
    a=0;
    printf("%d\n", a++);  // 输出为：0
    printf("%d\n", a);    // 输出为：1
    ```
  - `--` 可以在读取一个变量的取值的同时，将该变量的取值减 1 ，用法与 `++` 同理。

- 以下是条件运算符，它属于三元运算符：
  ```c
  表达式1 ? 表达式2 : 表达式3
  ```
  - 语法为：若表达式 1 结果为 true ，则执行表达式 2 并返回运算结果。若表达式 1 结果为 false ，则执行表达式 3 并返回运算结果。
  - 例：
    ```c
    int a;
    a = 'A'==65 ? 1 : 0;
    ```

- 如果一个表达式中，包含多个运算符，则需要考虑各个运算符的优先级。
  - 如果几个运算符的优先级不同，则找到优先级最高的那个运算符，优先执行它。
  - 如果几个运算符的优先级相同，则按照从左到右的顺序，逐个执行这些运算符，称为左结合性。但某些运算符是右结合性。
    - 例如 `printf("%d\n", 1<3<2);` 的输出为 1 ，因为先计算最左侧的 `<` 运算符，发现 `1<3` 的运算结果为 1 。然后计算 `1<2` ，结果为 1。
  - 各种运算符，按优先级从大到小排列如下：
    - `()` 括号、`[]` 下标
      - 例如 `if(x-- > 2)` 等价于 `if((x--) > 2)`
      - 例如 `if(!x || y--)` 等价于 `if((!x) || (y--))`
    - `!` 逻辑非、`++` 自增、`--` 自减、`+` `-` 正负号、`&` 取地址
      - 这些运算符都是右结合性。
      - 自增、自减运算符只能作用于变量。例如 `++x++` 按右结合性来看，等价于 `++(x++)` ，左边的 `++` 作用于表达式 `(x++)` ，因此语法错误。
    - `*` 乘法、`/` 除法、`%` 取模
    - `+` 加法、`-` 减法
    - `<<` 按位左移、`>>` 按位右移
    - 关系运算符
    - `&&` 逻辑与、`||` 逻辑或
    - 条件运算符
    - `=` 赋值
    - `,` 逗号
      - 逗号的优先级最低。
      - 由逗号连接的多个表达式，称为逗号表达式。C 语言会按左结合性，依次计算各个表达式，然后返回最后一个表达式的值，作为整个逗号表达式的结果。
      - 例：
        ```c
        int a = 0;
        printf("%d\n", (a++, a++, a));  // 输出为 2
        ```

## 流程控制

- C 语言提供了以下几种语法，来控制程序的运行流程：
  - 选择结构
    - if
    - match-case
  - 循环结构
    - for
    - while
    - do-while

### if

- if 语句用于判断条件、选择分支，最简单的格式如下：
  ```py
  if(condition){
      statement_block
  }
  ```
  - 如果 condition 条件表达式结果为 true ，则会执行 statement_block 语句块。否则，跳过 statement_block 。
  - 例：
    ```c
    if(1 > 0)
        printf("yes\n");
    ```
- 可选加上 else 语句，表示条件表达式为 false 时，执行什么操作。如下：
  ```py
  if(condition){
      statement_block
  }
  else{
      statement_block
  }
  ```
- 可选加上任意个 else if 语句，从而依次判断多个条件表达式。如下：
  ```py
  if(condition){
      statement_block
  }
  else if(condition){
      statement_block
  }
  else if(condition){
      statement_block
  }
  ```

- condition 怎么写？
  - 通常是一个表达式，使用比较运算符，或者逻辑运算符。使得表达式的运算结果为整型 1 或 0 ，表示条件为真或假。
  - 也可以是其它类型的表达式，使得运算结果为其它数字、字符、字符串，此时都视作条件为真。如下：
    ```c
    if(1 + 2) // 结果为 3
    if(' ')   // 结果为一个空格字符
    if("")    // 结果为一个空字符串
    ```

### switch

- 如果一个表达式，存在多个可能的取值，需要分情况处理。则可以用多层 else if ，但用 switch 语句更简洁。格式如下：
  ```c
  switch(表达式){
  case value1:    // case 语句的结尾有冒号
      语句块
      break;
  case value2:    // 多个 case 可以共用一个语句块
  case value3:
      语句块
      break;
  default:
      语句块
  }
  ```
  运行流程如下：
  - 首先执行 switch 表达式，得到一个值。然后从上到下检查各个 case ，如果 switch 值与某个 case 值相等，则执行该 case 的语句块。
    - switch 表达式的运算结果，必须是数字或字符、字符串类型。
    - case 的值，必须是常量，不能是变量。
  - 执行每个 case 语句块时，
    - 如果遇到了 break 语句，则会退出整个 switch 语句，执行后续代码。
    - 如果该 case 不存在 break 语句，则会继续检查下一个 case 。
  - 如果没有执行任何 case 语句块，则执行 default 语句块。不过，default 语句块可以省略不写。

- 例：
  ```c
  int x=0;
  switch(a+1){
  case 0:
      printf("hello\n");
      break;
  case 1:
  case '1':
      printf("world\n");
      break;
  default:
      printf("default\n");
  }
  ```

### for

- for 语句用于在某个条件为真时，循环执行某个语句块。格式如下：
  ```c
  for(表达式1; 表达式2; 表达式3){
      循环体语句块
  }
  ```
  运行流程如下：
  - 首先执行一次表达式 1 。
  - 然后判断表达式 2 （属于条件表达式）的结果是真是假。
    - 如果表达式 2 为真，则执行作为循环体的语句块。然后执行一次表达式 3 ，再次判断表达式 2 的真假。
    - 如果表达式 2 为假，则退出 for 循环。
  - 执行循环体时，
    - 如果遇到 break 语句，则会退出该层循环结构。
    - 如果遇到 continue 语句，则会结束本次循环，跳到开始下一次循环。
- 例：打印一连串数字
  ```c
  int i;
  for(i=0; i<5; i++)
      printf("%d\n", i);
  ```

### while

- while 语句相当于简化版的 for 语句。格式如下：
  ```c
  while(条件表达式){
      循环体;
  }
  ```
  运行流程如下：
  - 判断条件表达式的结果是真是假。
    - 如果为真，则执行作为循环体的语句块。然后再次判断条件表达式。
    - 如果为假，则退出 while 循环。

### do-while

- do-while 语句与 while 语句类似，但是先执行一次循环体，然后判断条件表达式。格式如下：
  ```c
  do{
      循环体;
  }
  while(条件表达式);  // 注意这句结尾有分号
  ```

### goto

- goto 用于跳转到指定一个标签，执行从这里开始的代码。
- 优点：可以随意改变程序的运行流程，灵活性大。
- 缺点：灵活性太大，导致源代码难以被人类阅读。因此尽量不用 goto 。
- 例：
  ```c
  #include <stdio.h>

  int main() {
      step1: printf("hello\n");
      step2: printf("world\n");
      goto step1;   // 此时跳转到 step1 处执行代码，而 step1 下面又遇到这个 goto ，导致死循环
      return 0;
  }
  ```

## 函数
